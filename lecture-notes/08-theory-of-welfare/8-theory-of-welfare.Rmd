---
title: "Lecture 8"
subtitle: "Theory of applied welfare analysis"
author: Ivan Rudik
date: AEM 6510
output:
  xaringan::moon_reader:
    css: ['default', 'metropolis', 'metropolis-fonts', 'my-css.css']
    # self_contained: true
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
      ratio: '16:9'


---
exclude: true
```{r setup}
if (!require("pacman")) install.packages("pacman")
pacman::p_load(
  tidyverse, tidylog, xaringanExtra, rlang, patchwork
)
options(htmltools.dir.version = FALSE)
knitr::opts_hooks$set(fig.callout = function(options) {
  if (options$fig.callout) {
    options$echo <- FALSE
  }
knitr::opts_chunk$set(echo = TRUE, fig.align="center")
  options
})
```
```{r xaringanExtra, echo = FALSE}
xaringanExtra::use_xaringan_extra(c("tile_view", "panelset", "webcam"))

```
```{r echo=FALSE}
xaringanExtra::style_panelset(panel_tab_color_active = "red")
```

---

# Roadmap

- Review welfare theory
- Understand how the theory can be used to measure changes in welfare from changes in prices
- Understand different kinds of welfare measures, and when to use them

---

# Establishing value

How do we establish monetary value?

We need at minimum two things:

--

A defined baseline state and an ending state (i.e. a change)

--

Measures of a person's:

- .hi-blue[Willingness to pay] to secure the ending state, or
- .hi-red[willingness to accept] to forgo the ending state

--

WTP and WTA are income-equivalents that link the starting and ending states to preferences

---

# How to think about it

Suppose there is a price decrease for a private good

--

A lower price widens the range of consumption outcomes (income effect) and potentially increases well-being

--

The starting state is the initial price

--

The ending state is the new price

--

WTP is how much the person is willing to give up to have the new price

--

WTA is how much the person needs to be given in lieu of the price decrease

---

# WTP and WTA

WTP and WTA are nice because they translate preferences into money equivalents

--

e.g. substitutability matters
- If there's a lot of substitutes for the good, the price decrease isn't that valuable
- If there's few substitutes, the price decrease may be very valuable

---

# The general model

Our goal is to use observed behavior (data) to tell us the structure of preferences needed to calculate welfare measures

--

We first need a model that gives rise to observed behavior

--

Let's start with a generalization of our consumer model

---

# The general model

Utility is $U(x,z,q)$
--

- $x$ is a vector of private goods
--

- $z$ is the numeraire with price = 1
--

- $q$ is a vector of environmental goods

--

$q$ can be a bunch of stuff, here we assume it's a good $(U_q > 0)$:
--

- Recreation
--

- Health impacts
--

- Ecosystem services
--

- etc

---

# The general model

The consumer maximizes utility given some fixed level of $q$, vector of market prices $p = \{p_1,...,p_J\}$, and income $y$:
$$\max_{z,x} U(x,z,q) + \lambda[y - z - p\cdot x]$$

--

This gives us the following FOCs:
$$U_{x_j} = \lambda p_j\,\,\,\,\, j = 1,\dots, J$$
and
$$U_z = \lambda$$

---

# The general model

With the FOCs we can solve for the ordinary demand functions $x_j(p,y,q)$, the Lagrange multiplier $\lambda(p,y,q)$, and $z$.

--

Note we can directly estimate ordinary demand functions since they depend on observables $p, y, q$

--

If we substitute $x_j$ into $U$ we get the .hi-blue[indirect utility function] $V(p,y,q)$ which tells us the maximized level of utility given prices, income, and environmental quality

--

Note that $\lambda$ is interpreted as the marginal utility of income

---

# The general model

We can also represent the consumer's behavior by the dual expenditure minimization problem:
$$\min_{x,z} p\cdot x + z + \mu[\bar{u} - U(x,z,q)]$$
where $\bar{u}$ is a reference level of utility

--

We are minimizing costs subject to keeping utility constant at some arbitrary level

--

Next, get the FOCs

---

# The general model

\begin{align}
  U_{x_j} &= p_j/\mu \\
  U_z &= 1/\mu \\
  U(x,z,q) &= \bar{u}
\end{align}

--

These FOCs allow us to derive .hi-blue[compensated demand functions] $h_j(p, \bar{u}, q)$

--

Note that these are .hi-red[not] directly estimable because we do not observe $\bar{u}$

--

If we substitute the $h_j's$ into the minimization problem we get the expenditure function $E(p,\bar{u},q)$ which is the minimum income required to achieve $\bar{u}$

---

# Duality

The utility max and cost min problems are linked and critical in applied welfare analysis

--

Suppose $u^0$ is the utility level obtained in the utility max problem

--

This gives us that $E(p,u^0,q)$ is the required expenditure

--

And by construction, $y = E(p,u^0,q)$

--

This links the solutions to utility max and cost min at the observed point of consumption by:
$$x_j(p,E(p,u^0,q),q) \equiv h_j(p,u^0,q) \,\,\,\,\, \forall j$$

---

# Duality

$$x_j(p,E(p,u^0,q),q) \equiv h_j(p,u^0,q) \,\,\,\,\, \forall j$$

--

We can now determine the price responses for both kinds of demand functions by differentiating wrt $p_j$:
\begin{align}
  {\partial x_j \over \partial p_j} &= {\partial h_j \over \partial p_j} - {\partial x_j \over \partial y}\times {\partial E_j \over p_j} \\
  &= {\partial h_j \over \partial p_j} - {\partial x_j \over \partial y}\times x_j
\end{align}

--

The second equality comes from Shephard's Lemma: $h_j = {\partial E_j \over \partial p_j}$ (envelope theorem) and the fact that $x_j(p,E(p,u^0,q),q) \equiv h_j(p,u^0,q)$

---

# Ordinary and compensated demand

$${\partial x_j \over \partial p_j}  ={\partial h_j \over \partial p_j} - {\partial x_j \over \partial y}\times x_j$$

What does this result show us?

--

- The difference between compensated and ordinary demand is an .hi-blue[income gradient]
  - If there's no income effect ${\partial x_j \over \partial y}$, then they are equivalent

---

# Ordinary and compensated demand

$${\partial x_j \over \partial p_j}  ={\partial h_j \over \partial p_j} - {\partial x_j \over \partial y}\times x_j$$

What does this result show us?

--

- Utility is held constant for movements in price along the *compensated* demand curve, but not the ordinary demand curve
  - Moving along the ordinary demand curve confounds the pure price effect, and an implicit income effect (i.e. the substitution and income effects)
  
--

This is important to understand the types of welfare measures we will be using

---

# Price change welfare measures

Suppose there is a change in the price of a private good and we want to know how it affects a person or group's well-being

--

e.g. how does subsidized tuition affect low income households?

--

There are two concepts we can use to measure this effect, which just differ in reference point

---

# Compensating variation

The first concept is .hi-blue[compensating variation] (CV)

--

> Given a price decrease (increase), the CV is the amount of money that would need to be taken from (given to) a person to restore the original utility level.

CV uses the .hi-red[pre-change] level of utility as a reference point

--

CV is the income offset that gives you the pre-change utility back following the price change

---

# Compensating variation

Given a change in price from $p^0 to p^1 < p^0$ the CV is:
$$V(p^0,y,q) = V(p^1,y-CV,q)$$
where $V$ is the indirect (maximized) utility function

--

LHS is maximized utility at the baseline price, RHS is maximized utility at the new price taking into account the behavioral change

--

CV is the adjustment to the post-change maximized utility's income level that makes it equal to the pre-change utility

--

Here $CV > 0$ since we are looking at a price decrease

---

# Compensating variation

CV can also be interpreted as WTP or WTA measures

--

CV is the maximum someone is willing to pay to have a lower price
- Anything less provides a utility improvement

--

CV is the minimum someone is willing to accept to have a higher price
- Anything more provides a utility improvement

---

# Equivalent variation

The second concept is .hi-blue[equivalent variation] (EV)

> For a price decrease (increase) that provides a higher (lower) utility level, the EV is the payment (reduction) that moves the person to the new utility level, without the price change

EV uses the post-change level of utility as the reference, it's the income change that puts them at the post-change level of utility without the price change occuring

---

# Equvalent variation

Given a change in price from $p^0 to p^1 < p^0$ the CV is:
$$V(p^1,y,q) = V(p^0,y+CV,q)$$
--

LHS is maximized utility at the baseline (changed) price, RHS is maximized utility at the old price but with an income adjustment to keep utility equal

--

Here $EV > 0$ since we are looking at a price decrease

---

# Compensating variation

CV can also be interpreted as WTP or WTA measures

--

CV is the maximum someone is willing to pay to have a lower price
- Anything less provides a utility improvement

--

CV is the minimum someone is willing to accept to have a higher price
- Anything more provides a utility improvement